(function(gh){const{nonces:nonces,i18n:i18n}=gh;const{_ghnonce:_ghnonce}=nonces;const{adminAjax:adminAjax}=gh;const loadingDots=el=>{let dotsHolder=document.createElement("span");dotsHolder.classList.add("loading-dots");el.appendChild(dotsHolder);const stop=()=>{clearInterval(interval);dotsHolder.remove()};const interval=setInterval(()=>{if(dotsHolder.innerText.length>=3){dotsHolder.innerText="."}else{dotsHolder.innerText=dotsHolder.innerText+"."}},500);return{stop:stop}};let ajaxFinEvt=new CustomEvent("ajaxfinished");const handleAjaxForms=()=>{document.querySelectorAll("form.gh-form.ajax-submit").forEach(__form=>{__form.addEventListener("submit",e=>{e.preventDefault();let form=e.currentTarget;let submitText="";let btn=form.querySelector('button[type="submit"]');btn.disabled=true;submitText=btn.innerHTML;btn.innerHTML=i18n.submitting;let{stop:stop}=loadingDots(btn);form.parentNode.querySelectorAll(".gh-message-wrapper").forEach(el=>el.remove());let fd=new FormData(form);fd.append("_ghnonce",_ghnonce);fd.append("action","groundhogg_ajax_form_submit");let captchaValidated=true;if(form.querySelectorAll(".gh-recaptcha-v3").length>0){captchaValidated=false}if(fd.has("g-recaptcha-response")){captchaValidated=true}if(captchaValidated){adminAjax(fd).then(r=>{stop();btn.innerHTML=submitText;btn.disabled=false;if(r.success===undefined){return}if(r.success){let msg=document.createElement("div");msg.innerHTML=r.data.message;msg.classList.add(...["gh-message-wrapper","gh-form-success-wrapper"]);form.parentNode.appendChild(msg);form.reset()}else{let msg=document.createElement("div");msg.innerHTML=r.data.html;form.parentNode.insertBefore(msg.firstChild,form)}form.dispatchEvent(ajaxFinEvt)}).catch(e=>{alert(e.message)})}})})};window.addEventListener("load",handleAjaxForms)})(Groundhogg);