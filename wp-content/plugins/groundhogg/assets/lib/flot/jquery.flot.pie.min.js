!function($){var e=10,i=.95;var s={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(e,i){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+i.color+";'>"+e+"<br/>"+Math.round(i.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};$.plot.plugins.push({init:function(s){var t=null,r=null,a=null,l=null,n=null,o=null,p=!1,h=null,g=[];function c(e,i,s){p||(p=!0,t=e.getCanvas(),r=$(t).parent(),a=e.getOptions(),e.setData(function(e){for(var i=0,s=0,t=0,r=a.series.pie.combine.color,l=[],n=0;n<e.length;++n){var o=e[n].data;$.isArray(o)&&1==o.length&&(o=o[0]),$.isArray(o)?!isNaN(parseFloat(o[1]))&&isFinite(o[1])?o[1]=+o[1]:o[1]=0:o=!isNaN(parseFloat(o))&&isFinite(o)?[1,+o]:[1,0],e[n].data=[o]}for(var n=0;n<e.length;++n)i+=e[n].data[0][1];for(var n=0;n<e.length;++n){var o=e[n].data[0][1];o/i<=a.series.pie.combine.threshold&&(s+=o,t++,r||(r=e[n].color))}for(var n=0;n<e.length;++n){var o=e[n].data[0][1];(t<2||o/i>a.series.pie.combine.threshold)&&l.push($.extend(e[n],{data:[[1,o]],color:e[n].color,label:e[n].label,angle:o*Math.PI*2/i,percent:o/(i/100)}))}return t>1&&l.push({data:[[1,s]],color:r,label:a.series.pie.combine.label,angle:s*Math.PI*2/i,percent:s/(i/100)}),l}(e.getData())))}function u(s,t){if(r){var g=s.getPlaceholder().width(),c=s.getPlaceholder().height(),u=r.children().filter(".legend").children().width()||0;h=t,p=!1,l=Math.min(g,c/a.series.pie.tilt)/2,o=c/2+a.series.pie.offset.top,n=g/2,"auto"==a.series.pie.offset.left?(a.legend.position.match("w")?n+=u/2:n-=u/2,n<l?n=l:n>g-l&&(n=g-l)):n+=a.series.pie.offset.left;var f=s.getData(),v=0;do{v>0&&(l*=i),v+=1,b(),a.series.pie.tilt<=.8&&w()}while(!k()&&v<e);v>=e&&(b(),r.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>")),s.setSeries&&s.insertLegend&&(s.setSeries(f),s.insertLegend())}function b(){h.clearRect(0,0,g,c),r.children().filter(".pieLabel, .pieLabelBackground").remove()}function w(){var e=a.series.pie.shadow.left,i=a.series.pie.shadow.top,s=a.series.pie.shadow.alpha,t=a.series.pie.radius>1?a.series.pie.radius:l*a.series.pie.radius;if(!(t>=g/2-e||t*a.series.pie.tilt>=c/2-i||t<=10)){h.save(),h.translate(e,i),h.globalAlpha=s,h.fillStyle="#000",h.translate(n,o),h.scale(1,a.series.pie.tilt);for(var r=1;r<=10;r++)h.beginPath(),h.arc(0,0,t,0,2*Math.PI,!1),h.fill(),t-=r;h.restore()}}function k(){var e=Math.PI*a.series.pie.startAngle,i=a.series.pie.radius>1?a.series.pie.radius:l*a.series.pie.radius;h.save(),h.translate(n,o),h.scale(1,a.series.pie.tilt),h.save();for(var s=e,t=0;t<f.length;++t)f[t].startAngle=s,p(f[t].angle,f[t].color,!0);if(h.restore(),a.series.pie.stroke.width>0){for(h.save(),h.lineWidth=a.series.pie.stroke.width,s=e,t=0;t<f.length;++t)p(f[t].angle,a.series.pie.stroke.color,!1);h.restore()}return d(h),h.restore(),!a.series.pie.label.show||function(){for(var i=e,s=a.series.pie.label.radius>1?a.series.pie.label.radius:l*a.series.pie.label.radius,t=0;t<f.length;++t){if(f[t].percent>=100*a.series.pie.label.threshold&&!p(f[t],i,t))return!1;i+=f[t].angle}return!0;function p(e,i,t){if(0==e.data[0][1])return!0;var l,p=a.legend.labelFormatter,h=a.series.pie.label.formatter;l=p?p(e.label,e):e.label,h&&(l=h(l,e));var u=(i+e.angle+i)/2,d=n+Math.round(Math.cos(u)*s),f=o+Math.round(Math.sin(u)*s)*a.series.pie.tilt,v="<span class='pieLabel' id='pieLabel"+t+"' style='position:absolute;top:"+f+"px;left:"+d+"px;'>"+l+"</span>";r.append(v);var b=r.children("#pieLabel"+t),w=f-b.height()/2,k=d-b.width()/2;if(b.css("top",w),b.css("left",k),0-w>0||0-k>0||c-(w+b.height())<0||g-(k+b.width())<0)return!1;if(0!=a.series.pie.label.background.opacity){var M=a.series.pie.label.background.color;null==M&&(M=e.color);var P="top:"+w+"px;left:"+k+"px;";$("<div class='pieLabelBackground' style='position:absolute;width:"+b.width()+"px;height:"+b.height()+"px;"+P+"background-color:"+M+";'></div>").css("opacity",a.series.pie.label.background.opacity).insertBefore(b)}return!0}}();function p(e,t,r){e<=0||isNaN(e)||(r?h.fillStyle=t:(h.strokeStyle=t,h.lineJoin="round"),h.beginPath(),Math.abs(e-2*Math.PI)>1e-9&&h.moveTo(0,0),h.arc(0,0,i,s,s+e/2,!1),h.arc(0,0,i,s+e/2,s+e,!1),h.closePath(),s+=e,r?h.fill():h.stroke())}}}function d(e){if(a.series.pie.innerRadius>0){e.save();var i=a.series.pie.innerRadius>1?a.series.pie.innerRadius:l*a.series.pie.innerRadius;e.globalCompositeOperation="destination-out",e.beginPath(),e.fillStyle=a.series.pie.stroke.color,e.arc(0,0,i,0,2*Math.PI,!1),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),e.strokeStyle=a.series.pie.stroke.color,e.arc(0,0,i,0,2*Math.PI,!1),e.stroke(),e.closePath(),e.restore()}}function f(e,i){for(var s=!1,t=-1,r=e.length,a=r-1;++t<r;a=t)(e[t][1]<=i[1]&&i[1]<e[a][1]||e[a][1]<=i[1]&&i[1]<e[t][1])&&i[0]<(e[a][0]-e[t][0])*(i[1]-e[t][1])/(e[a][1]-e[t][1])+e[t][0]&&(s=!s);return s}function v(e){w("plothover",e)}function b(e){w("plotclick",e)}function w(e,i){var t=s.offset(),p=function(e,i){for(var t,r,a=s.getData(),p=s.getOptions(),g=p.series.pie.radius>1?p.series.pie.radius:l*p.series.pie.radius,c=0;c<a.length;++c){var u=a[c];if(u.pie.show){if(h.save(),h.beginPath(),h.moveTo(0,0),h.arc(0,0,g,u.startAngle,u.startAngle+u.angle/2,!1),h.arc(0,0,g,u.startAngle+u.angle/2,u.startAngle+u.angle,!1),h.closePath(),t=e-n,r=i-o,h.isPointInPath){if(h.isPointInPath(e-n,i-o))return h.restore(),{datapoint:[u.percent,u.data],dataIndex:0,series:u,seriesIndex:c}}else if(f([[0,0],[g*Math.cos(u.startAngle),g*Math.sin(u.startAngle)],[g*Math.cos(u.startAngle+u.angle/4),g*Math.sin(u.startAngle+u.angle/4)],[g*Math.cos(u.startAngle+u.angle/2),g*Math.sin(u.startAngle+u.angle/2)],[g*Math.cos(u.startAngle+u.angle/1.5),g*Math.sin(u.startAngle+u.angle/1.5)],[g*Math.cos(u.startAngle+u.angle),g*Math.sin(u.startAngle+u.angle)]],[t,r]))return h.restore(),{datapoint:[u.percent,u.data],dataIndex:0,series:u,seriesIndex:c};h.restore()}}return null}(parseInt(i.pageX-t.left),parseInt(i.pageY-t.top));if(a.grid.autoHighlight)for(var c=0;c<g.length;++c){var u=g[c];u.auto!=e||p&&u.series==p.series||k(u.series)}p&&function(e,i){var t=M(e);-1==t?(g.push({series:e,auto:i}),s.triggerRedrawOverlay()):i||(g[t].auto=!1)}(p.series,e);var d={pageX:i.pageX,pageY:i.pageY};r.trigger(e,[d,p])}function k(e){null==e&&(g=[],s.triggerRedrawOverlay());var i=M(e);-1!=i&&(g.splice(i,1),s.triggerRedrawOverlay())}function M(e){for(var i=0;i<g.length;++i)if(g[i].series==e)return i;return-1}s.hooks.processOptions.push(function(e,i){i.series.pie.show&&(i.grid.show=!1,"auto"==i.series.pie.label.show&&(i.legend.show?i.series.pie.label.show=!1:i.series.pie.label.show=!0),"auto"==i.series.pie.radius&&(i.series.pie.label.show?i.series.pie.radius=.75:i.series.pie.radius=1),i.series.pie.tilt>1?i.series.pie.tilt=1:i.series.pie.tilt<0&&(i.series.pie.tilt=0))}),s.hooks.bindEvents.push(function(e,i){var s=e.getOptions();s.series.pie.show&&(s.grid.hoverable&&i.unbind("mousemove").mousemove(v),s.grid.clickable&&i.unbind("click").click(b))}),s.hooks.processDatapoints.push(function(e,i,s,t){e.getOptions().series.pie.show&&c(e)}),s.hooks.drawOverlay.push(function(e,i){e.getOptions().series.pie.show&&function(e,i){var s=e.getOptions(),t=s.series.pie.radius>1?s.series.pie.radius:l*s.series.pie.radius;i.save(),i.translate(n,o),i.scale(1,s.series.pie.tilt);for(var r=0;r<g.length;++r)a(g[r].series);function a(e){e.angle<=0||isNaN(e.angle)||(i.fillStyle="rgba(255, 255, 255, "+s.series.pie.highlight.opacity+")",i.beginPath(),Math.abs(e.angle-2*Math.PI)>1e-9&&i.moveTo(0,0),i.arc(0,0,t,e.startAngle,e.startAngle+e.angle/2,!1),i.arc(0,0,t,e.startAngle+e.angle/2,e.startAngle+e.angle,!1),i.closePath(),i.fill())}d(i),i.restore()}(e,i)}),s.hooks.draw.push(function(e,i){e.getOptions().series.pie.show&&u(e,i)})},options:s,name:"pie",version:"1.1"})}(jQuery);