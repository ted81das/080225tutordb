var R=Object.defineProperty;var v=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var N=(t,l,e)=>l in t?R(t,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[l]=e,b=(t,l)=>{for(var e in l||(l={}))$.call(l,e)&&N(t,e,l[e]);if(v)for(var e of v(l))G.call(l,e)&&N(t,e,l[e]);return t};import{f as S,j as s,r as I,L as A}from"./main-217.js";import{d as V,_ as a}from"./bi.519.0.js";import{a as q,h as U}from"./bi.920.3.js";import{x as w,a9 as D}from"./bi.457.443.js";import{T as O}from"./bi.530.724.js";import{a as F}from"./bi.358.9.js";import{b as j}from"./bi.322.11.js";import{g as y,m as P}from"./bi.930.815.js";import{g as k}from"./bi.854.817.js";const M=(t,l,e)=>{const c=b({},l);c.field_map.splice(t,0,{}),e(b({},c))},B=(t,l,e)=>{const c=b({},l);c.field_map.length>1&&c.field_map.splice(t,1),e(b({},c))},T=(t,l,e,c)=>{const r=b({},e);r.field_map[l][t.target.name]=t.target.value,t.target.value==="custom"&&(r.field_map[l].customValue=""),c(b({},r))};function E({i:t,formFields:l,field:e,mailerLiteConf:c,setMailerLiteConf:r}){var g;const x=S(V),{isPro:p}=x,d=(c==null?void 0:c.mailerLiteFields.filter(n=>n.required===!0))||[],h=(c==null?void 0:c.mailerLiteFields.filter(n=>n.required===!1))||[];return s.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:s.jsxs("div",{className:"pos-rel flx",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:n=>T(n,t,c,r),children:[s.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),s.jsx("optgroup",{label:a("Form Fields","bit-integrations"),children:l==null?void 0:l.map(n=>s.jsx("option",{value:n.name,children:n.label},`ff-rm-${n.name}`))}),s.jsx("option",{value:"custom",children:a("Custom...","bit-integrations")}),s.jsx("optgroup",{label:sprintf(a("General Smart Codes %s","bit-integrations"),p?"":`(${a("Pro","bit-integrations")})`),children:p&&((g=q)==null?void 0:g.map(n=>s.jsx("option",{value:n.name,children:n.label},`ff-rm-${n.name}`)))})]}),e.formField==="custom"&&s.jsx(O,{onChange:n=>U(n,t,c,r),label:a("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:e.customValue,placeholder:a("Custom Value","bit-integrations"),formFields:l}),s.jsxs("select",{className:"btcd-paper-inp",disabled:t<d.length,name:"mailerLiteFormField",value:t<d?d[t].label||"":e.mailerLiteFormField||"",onChange:n=>T(n,t,c,r),children:[s.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),t<d.length?s.jsx("option",{value:d[t].key,children:d[t].label},d[t].key):h.map(({key:n,label:m})=>s.jsx("option",{value:n,children:m},n))]})]}),t>=d.length&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>M(t,c,r),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),s.jsx("button",{onClick:()=>B(t,c,r),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:s.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function H({mailerLiteConf:t,setMailerLiteConf:l,loading:e,setLoading:c}){var n,m,_;const[r,x]=I.useState({show:!1,action:()=>{}}),p=(i,o)=>{const u=b({},t);o==="group"&&y(t,l,e,c),i.target.checked?u.actions[o]=!0:delete u.actions[o],x({show:o}),l(b({},u))},d=()=>{x({show:!1})},h=(i,o)=>{const u=b({},t);o==="group_ids"&&i.length?u.actions.group=!0:o==="group_ids"&&i.length<1&&delete u.actions.group,o==="mailer_lite_type"&&i.length?u.actions.mailer_lite_type=!0:o==="mailer_lite_type"&&i.length<1&&delete u.actions.mailer_lite_type,u[o]=i,l(b({},u))},g=[{label:a("Active","bit-integrations"),value:"active"},{label:a("Unsubscribed","bit-integrations"),value:"unsubscribed"},{label:a("Bounced","bit-integrations"),value:"bounced"},{label:a("Spam Complaints","bit-integrations"),value:"junk"},{label:a("Unconfirmed","bit-integrations"),value:"unconfirmed"}];return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"pos-rel d-flx w-8",children:[s.jsx(j,{checked:(t==null?void 0:t.group_ids.length)||!1,onChange:i=>p(i,"group"),className:"wdt-200 mt-4 mr-2",value:"group",title:a("Groups","bit-integrations"),subTitle:a("Add Groups","bit-integrations")}),s.jsx(j,{checked:(t==null?void 0:t.mailer_lite_type)||!1,onChange:i=>p(i,"mailer_lite_type"),className:"wdt-200 mt-4 mr-2",value:"type",title:a("Type","bit-integrations"),subTitle:a("Add Type","bit-integrations")}),s.jsx(j,{checked:((n=t.actions)==null?void 0:n.double_opt_in)||!1,onChange:i=>p(i,"double_opt_in"),className:"wdt-200 mt-4 mr-2",value:"double_opt_in",title:a("Double Opt-in","bit-integrations"),subTitle:a("Add Double Opt-in","bit-integrations")}),s.jsx(j,{checked:((m=t.actions)==null?void 0:m.update)||!1,isInfo:t==null?void 0:t.group_ids.length,onChange:i=>p(i,"update"),className:"wdt-200 mt-4 mr-2",value:"user_share",title:a("Update subscriber","bit-integrations"),subTitle:a("Update Responses with MailerLite exist Subscriber?","bit-integrations")})]}),s.jsxs(F,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:a("Ok","bit-integrations"),show:r.show==="group",close:d,action:d,title:a("Groups","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.group?s.jsx(A,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):s.jsxs("div",{className:"flx flx-between mt-2",children:[s.jsx(w,{className:"msl-wrp-options",defaultValue:t==null?void 0:t.group_ids,options:(_=t==null?void 0:t.groups)==null?void 0:_.map(i=>({label:i.name,value:i.group_id})),onChange:i=>h(i,"group_ids"),customValue:!0}),s.jsx("button",{onClick:()=>y(t,l,e,c),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${a("Refresh Groups","bit-integrations")}'`},type:"button",disabled:e.group,children:"↻"})]})]}),s.jsxs(F,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:a("Ok","bit-integrations"),show:r.show==="mailer_lite_type",close:d,action:d,title:a("Type","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2 mb-2"}),s.jsx("div",{className:"flx flx-between mt-2",children:s.jsx(w,{className:"msl-wrp-options",defaultValue:t==null?void 0:t.mailer_lite_type,options:g.map(i=>({label:i.label,value:i.value})),onChange:i=>h(i,"mailer_lite_type"),customValue:!0,singleSelect:!0})})]})]})}function ss({formFields:t,handleInput:l,mailerLiteConf:e,setMailerLiteConf:c,loading:r,setLoading:x,setSnackbar:p}){const d=S(V),{isPro:h}=d;return s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("b",{className:"wdt-200 d-in-b",children:a("Select Action:","bit-integrations")}),s.jsxs("select",{onChange:l,name:"action",value:e==null?void 0:e.action,className:"btcd-paper-inp w-5",children:[s.jsx("option",{value:"",children:a("Select an action","bit-integrations")}),s.jsx("option",{value:"add_subscriber","data-action_name":"add_subscriber",children:a("Add Subscriber","bit-integrations")}),s.jsx("option",{value:"delete_subscriber","data-action_name":"delete_subscriber",disabled:e.mailer_lite_type==="v1"||!h,children:h?a("Delete subscriber","bit-integrations"):k(a("Delete subscriber","bit-integrations"))}),s.jsx("option",{value:"forget_subscriber","data-action_name":"forget_subscriber",disabled:e.mailer_lite_type==="v1"||!h,children:h?a("Forget subscriber","bit-integrations"):k(a("Forget subscriber","bit-integrations"))})]}),r.field&&s.jsx(A,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),(e==null?void 0:e.action)&&!(r!=null&&r.field)&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mt-5",children:s.jsxs("b",{className:"wdt-100",children:[a("Field Map","bit-integrations"),s.jsx("button",{onClick:()=>P(e,c,r,x),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Fields"'},type:"button",disabled:r.field,children:"↻"})]})}),s.jsx("br",{}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:a("Form Fields","bit-integrations")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:a("MailerLite Fields","bit-integrations")})})]}),e==null?void 0:e.field_map.map((g,n)=>s.jsx(E,{i:n,field:g,mailerLiteConf:e,formFields:t,setMailerLiteConf:c,setSnackbar:p},`rp-m-${n+9}`)),s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>M(e.field_map.length,e,c),className:"icn-btn sh-sm",type:"button",children:"+"})}),s.jsx("br",{}),s.jsx("br",{})]}),(e==null?void 0:e.action)&&(e==null?void 0:e.action)!=="add_subscriber"&&s.jsx(D,{note:z}),(e==null?void 0:e.action)&&(e==null?void 0:e.action)==="add_subscriber"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mt-4",children:s.jsx("b",{className:"wdt-100",children:a("Utilities","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsx(H,{mailerLiteConf:e,setMailerLiteConf:c,formFields:t,loading:r,setLoading:x})]})]})}const z=`
    <p>${a("This action requires a MailerLite New account. It isn’t supported with Classic accounts.","bit-integrations")}</p>
  `;export{ss as M};
