var q=Object.defineProperty;var _=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var F=(t,r,e)=>r in t?q(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,u=(t,r)=>{for(var e in r||(r={}))M.call(r,e)&&F(t,e,r[e]);if(_)for(var e of _(r))T.call(r,e)&&F(t,e,r[e]);return t};import{r as V,j as s,f as k,L as A}from"./main-217.js";import{x as f}from"./bi.457.443.js";import{_ as l,d as P}from"./bi.519.0.js";import{A as $}from"./bi.45.722.js";import{P as E}from"./bi.624.723.js";import{a as L}from"./bi.358.9.js";import{b as R}from"./bi.322.11.js";import{g as y}from"./bi.21.720.js";import{a as I}from"./bi.920.3.js";import{T as U}from"./bi.530.724.js";const N=(t,r,e,i="field_map")=>{const d=u({},r);d[i]||(d[i]=[]),d[i].splice(t,0,{}),e(u({},d))},B=(t,r,e,i="field_map")=>{const d=u({},r);d[i].length>1&&d[i].splice(t,1),e(u({},d))},G=(t,r,e,i,d="field_map")=>{var o;const n=u({},e);n[d][r].customValue=((o=t==null?void 0:t.target)==null?void 0:o.value)||t,i(u({},n))},j=(t,r,e,i,d="field_map")=>{const n=u({},e);n[d][r][t.target.name]=t.target.value,t.target.value==="custom"&&(n[d][r].customValue=""),i(u({},n))};function H({omniSendConf:t,setOmniSendConf:r,formFields:e,loading:i,setLoading:d}){const[n,o]=V.useState({show:!1,action:()=>{}}),x=(c,a)=>{const m=u({},t);a==="tag"&&(c.target.checked?m.actions.tag=!0:delete m.actions.tag,o({show:a})),r(u({},m))},b=()=>{o({show:!1})},g=(c,a)=>{const m=u({},t);a==="selected_tags"&&c.length?m.actions.selected_tags=!0:a==="selected_tags"&&c.length<1&&delete m.actions.selected_tags,m[a]=c,r(u({},m))};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"pos-rel d-flx w-8",children:s.jsx(R,{checked:(t==null?void 0:t.actions.tag)||!1,onChange:c=>x(c,"tag"),className:"wdt-200 mt-4 mr-2",value:"tags",title:l("Tags","bit-integrations"),subTitle:l("Add Custom Tags","bit-integrations")})}),s.jsxs(L,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:l("Ok","bit-integrations"),show:n.show==="tag",close:b,action:b,title:l("Add Custom Tags","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2 mb-2"}),s.jsx("div",{className:"flx flx-between mt-2",children:s.jsx(f,{className:"msl-wrp-options",defaultValue:t==null?void 0:t.selected_tags,options:[],onChange:c=>g(c,"selected_tags"),customValue:!0})})]})]})}function w({i:t,formFields:r,field:e,omniSendConf:i,setOmniSendConf:d,type:n}){var c;const o=k(P),{isPro:x}=o,b=(i==null?void 0:i.omniSend_fields.filter(a=>a.required===!0))||[],g=(i==null?void 0:i.omniSend_fields.filter(a=>a.required===!1))||[];return s.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:s.jsxs("div",{className:"pos-rel flx",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:a=>j(a,t,i,d,n),children:[s.jsx("option",{value:"",children:l("Select Field","bit-integrations")}),s.jsx("optgroup",{label:l("Form Fields","bit-integrations"),children:r==null?void 0:r.map(a=>s.jsx("option",{value:a.name,children:a.label},`ff-rm-${a.name}`))}),s.jsx("option",{value:"custom",children:l("Custom...","bit-integrations")}),s.jsx("optgroup",{label:sprintf(l("General Smart Codes %s","bit-integrations"),x?"":`(${l("Pro","bit-integrations")})`),children:x&&((c=I)==null?void 0:c.map(a=>s.jsx("option",{value:a.name,children:a.label},`ff-rm-${a.name}`)))})]}),e.formField==="custom"&&s.jsx(U,{onChange:a=>G(a,t,i,d,n),label:l("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:e.customValue,placeholder:l("Custom Value","bit-integrations"),formFields:r}),n==="field_map"?s.jsxs("select",{className:"btcd-paper-inp",disabled:t<b.length,name:"omniSendFormField",value:t<b?b[t].label||"":e.omniSendFormField||"",onChange:a=>j(a,t,i,d,n),children:[s.jsx("option",{value:"",children:l("Select Field","bit-integrations")}),t<b.length?s.jsx("option",{value:b[t].key,children:b[t].label},b[t].key):g.map(({key:a,label:m})=>s.jsx("option",{value:a,children:m},a))]}):s.jsx("input",{className:"btcd-paper-inp",name:"omniSendFormField",value:e.omniSendFormField||"",onChange:a=>j(a,t,i,d,n),type:"text"})]}),t>=b.length&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>N(t,i,d,n),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),s.jsx("button",{onClick:()=>B(t,i,d,n),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:s.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function S({formFields:t,handleInput:r,omniSendConf:e,setOmniSendConf:i,loading:d,setLoading:n,setSnackbar:o}){var g;const x=[{label:l("Email","bit-integrations"),value:"email"},{label:l("SMS","bit-integrations"),value:"sms"}],b=(c,a)=>{const m=c.search("email"),v=c.search("sms"),p=u({},e),h=p.omniSend_fields;c.length?(p.actions.channel=!0,m!==-1&&v!==-1?(h[0].required=!0,h[1].required=!0):m!==-1?(h[0].required=!0,h[1].required=!1):v!==-1?(h[1].required=!0,h[0].required=!1):(h[0].required=!1,h[1].required=!1)):(delete p.actions.channel,h[0].required=!1,h[1].required=!1),p[a]=c,p.field_map=y(p.omniSend_fields),i(u({},p))};return s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsxs("div",{className:"flx",children:[s.jsx("b",{className:"wdt-200 d-in-b",children:l("Channels","bit-integrations")}),s.jsx(f,{className:"msl-wrp-options  w-5",defaultValue:e==null?void 0:e.channels,options:x==null?void 0:x.map(c=>({label:c.label,value:c.value})),onChange:c=>b(c,"channels"),customValue:!0})]}),s.jsx("br",{}),e.channels.search("email")!==-1&&s.jsxs("div",{className:"flx",children:[s.jsx("b",{className:"wdt-200 d-in-b",children:l("Email Status:","bit-integrations")}),s.jsxs("select",{onChange:r,name:"email_status",value:e.email_status,className:"btcd-paper-inp w-5",required:!0,children:[s.jsx("option",{value:"",children:l("Select Status","bit-integrations")}),s.jsx("option",{value:"subscribed",children:l("Subscribed","bit-integrations")}),s.jsx("option",{value:"unsubscribed",children:l("Unsubscribed","bit-integrations")}),s.jsx("option",{value:"nonSubscribed",children:l("nonSubscribed","bit-integrations")})]})]}),s.jsx("br",{}),e.channels.search("sms")!==-1&&s.jsxs("div",{className:"flx",children:[s.jsx("b",{className:"wdt-200 d-in-b",children:l("SMS Status:","bit-integrations")}),s.jsxs("select",{onChange:r,name:"sms_status",value:e.sms_status,className:"btcd-paper-inp w-5",required:!0,children:[s.jsx("option",{value:"",children:l("Select Status","bit-integrations")}),s.jsx("option",{value:"subscribed",children:l("Subscribed","bit-integrations")}),s.jsx("option",{value:"unsubscribed",children:l("Unsubscribed","bit-integrations")}),s.jsx("option",{value:"nonSubscribed",children:l("nonSubscribed","bit-integrations")})]})]}),(e.channels.search("email")!==-1||e.channels.search("sms")!==-1)&&s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("div",{className:"mt-5",children:s.jsx("b",{className:"wdt-100",children:l("Field Map","bit-integrations")})}),s.jsx("br",{}),d.field&&s.jsx(A,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:l("Form Fields","bit-integrations")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:l("OmniSend Fields","bit-integrations")})})]}),e==null?void 0:e.field_map.map((c,a)=>s.jsx(w,{i:a,field:c,omniSendConf:e,formFields:t,setOmniSendConf:i,setSnackbar:o,type:"field_map"},`rp-m-${a+9}`)),s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>N(e.field_map.length,e,i,"field_map"),className:"icn-btn sh-sm",type:"button",children:"+"})}),s.jsx("br",{}),s.jsx("br",{}),s.jsxs($,{title:l("Custom Properties","bit-integrations"),children:[s.jsx("b",{className:"wdt-100",children:s.jsx(E,{title:l("Custom Properties","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-2 mb-4"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:l("Form Fields","bit-integrations")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:l("OmniSend Property name","bit-integrations")})})]}),(g=e==null?void 0:e.custom_field_map)==null?void 0:g.map((c,a)=>s.jsx(w,{i:a,field:c,omniSendConf:e,formFields:t,setOmniSendConf:i,setSnackbar:o,type:"custom_field_map"},`rp-m-${a+9}`)),s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>{var c;return N((c=e==null?void 0:e.custom_field_map)==null?void 0:c.length,e,i,"custom_field_map")},className:"icn-btn sh-sm",type:"button",children:"+"})})]}),s.jsx("div",{className:"mt-4",children:s.jsx("b",{className:"wdt-100",children:l("Actions","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsx(H,{omniSendConf:e,setOmniSendConf:i,formFields:t,loading:d,setLoading:n})]})]})}export{S as O};
